<ion-view view-title="Build">
    <ion-content class="build">

        <ion-refresher
            pulling-text="Pull to refresh"
            on-refresh="fetch()">
        </ion-refresher>

        <div class="list">

            <div class="item item-divider">
                Build Details
                <span class="build-number" ng-if="build.number">
                    <span ng-class="{ 'created': 'created', 'passed': 'passed', 'started': 'started', 'failed': 'failed', 'errored': 'errored', 'canceled': 'canceled'}[build.state]"><i class="icon ion-settings"></i> {{ build.number }}</span>
                </span>
            </div>

            <div class="item">
                <div class="commit-message">{{ commit.message }}</div>

                <div class="row">
                    <div class="col col-100">
                        <p ng-if="build.finished_at"><i class="icon ion-calendar"></i> Finished on {{ build.finished_at | timeAgo }}</p>
                        <p ng-if="!build.finished_at"><i class="icon ion-calendar"></i> Still Running</p>
                    </div>
                </div>

                <div class="row" ng-if="build.duration">
                    <div class="col col-100">
                        <p><i class="icon ion-clock"></i> Run for {{build.duration | convertSeconds }}</p>
                    </div>
                </div>

                <span class="badge"><i class="icon" ng-class="{ 'created': 'ion-ios7-circle-filled', 'passed': 'ion-checkmark-circled', 'started': 'ion-ios7-circle-filled', 'failed': 'ion-close-circled', 'errored': 'ion-alert-circled', 'canceled': 'ion-alert-circled' }[build.state]"></i></span>
            </div>

            <div class="item item-divider">Commit Info</div>
            <div class="item commit">
                <div class="row">
                    <div class="col col-100"><p><i class="icon ion-merge"></i> Branch: {{ commit.branch }}</p></div>
                </div>

                <div class="row" ng-if="build.pull_request">
                    <div class="col col-100">
                        <p><i class="icon ion-pull-request"></i> PR Title: {{ build.pull_request_title }}</span></p>
                    </div>
                </div>
                <div class="row" ng-if="build.pull_request">
                    <div class="col col-100">
                        <p><i class="icon ion-pull-request"></i> PR Number: {{ build.pull_request_number }}</span></p>
                    </div>
                </div>

                <div class="row">
                    <div class="col col-100">
                        <p><i class="icon ion-ios7-person"></i> Commiter: {{ commit.committer_name }}</p>
                    </div>
                </div>

                <div class="row compare" ng-if="!pro">
                    <div class="col col-100">
                        <button class="button button-block button-dark icon-left ion-social-github" ng-click="openCompare()">Compare Commit</button>
                    </div>
                </div>

            </div>

            <div class="item item-divider">Jobs</div>
            <a class="item job" ng-href="#/app/log/{{ job.log_id }}" ng-repeat="job in jobs">
                <p>Build #{{job.number }}</p>
                <span class="badge"><i class="icon" ng-class="{ 'created': 'ion-ios7-circle-filled', 'passed': 'ion-checkmark-circled', 'started': 'ion-ios7-circle-filled', 'failed': 'ion-close-circled', 'errored': 'ion-alert-circled', 'canceled': 'ion-alert-circled' }[job.state]"></i></span>
            </a>

        </div>

    </ion-content>
</ion-view>
